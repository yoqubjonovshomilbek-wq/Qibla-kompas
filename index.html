<!DOCTYPE html>
<html lang="uz">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>Islomiy Ilova</title>
<script src="https://telegram.org/js/telegram-web-app.js"></script>
<link href="https://fonts.googleapis.com/css2?family=Amiri:wght@400;700&family=Nunito:wght@400;700;800&family=Tajawal:wght@400;500;700&display=swap" rel="stylesheet">
<style>
*{margin:0;padding:0;box-sizing:border-box;-webkit-tap-highlight-color:transparent;}
:root{
  --g:#22c55e;--gd:#15803d;--gold:#d4a843;
  --bg:#070d17;--s1:#0b1a2e;--s2:#0f2139;--s3:#162b47;
  --bdr:rgba(34,197,94,0.15);--tx:#e2eef8;--mt:#4a6a86;
  --gw:rgba(34,197,94,0.35);
}
html,body{height:100%;overflow:hidden;}
body{font-family:'Tajawal',sans-serif;background:var(--bg);color:var(--tx);display:flex;flex-direction:column;height:100dvh;}

/* Stars bg */
.stars{position:fixed;inset:0;z-index:0;pointer-events:none}
.star{position:absolute;border-radius:50%;background:#fff;opacity:0;animation:twinkle var(--d) ease-in-out infinite var(--dl)}
@keyframes twinkle{0%,100%{opacity:0}50%{opacity:.5}}

/* NAV */
nav{display:flex;background:var(--s1);border-bottom:1px solid var(--bdr);flex-shrink:0;z-index:50;position:relative;}
.nb{flex:1;padding:10px 4px 8px;border:none;background:transparent;color:var(--mt);font-family:'Tajawal',sans-serif;font-size:10.5px;font-weight:600;cursor:pointer;display:flex;flex-direction:column;align-items:center;gap:2px;position:relative;transition:color .2s;}
.nb .ni{font-size:19px;}
.nb.on{color:var(--g);}
.nb::after{content:'';position:absolute;bottom:0;left:15%;right:15%;height:2px;border-radius:2px 2px 0 0;background:var(--g);transform:scaleX(0);transition:transform .25s;}
.nb.on::after{transform:scaleX(1);}

/* PAGES */
.pages{flex:1;position:relative;overflow:hidden;}
.pg{position:absolute;inset:0;overflow-y:auto;overflow-x:hidden;-webkit-overflow-scrolling:touch;opacity:0;pointer-events:none;transition:opacity .2s;}
.pg.on{opacity:1;pointer-events:all;}
.pg::-webkit-scrollbar{width:2px;}
.pg::-webkit-scrollbar-thumb{background:var(--s3);}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   TAB 1 â€” QIBLA
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
#pg0{display:flex;flex-direction:column;align-items:center;padding:16px 16px 30px;}

.qibla-card{width:100%;max-width:360px;background:var(--s1);border:1px solid var(--bdr);border-radius:20px;padding:20px;margin-bottom:14px;}
.qibla-title{font-family:'Amiri',serif;font-size:22px;color:var(--gold);text-align:center;margin-bottom:16px;text-shadow:0 0 20px rgba(212,168,67,.3);}

/* Arrow compass display */
.qibla-compass{position:relative;width:240px;height:240px;margin:0 auto 20px;}
.qc-ring{width:240px;height:240px;border-radius:50%;border:3px solid var(--bdr);background:radial-gradient(circle,#0f2139 60%,#070d17);position:relative;display:flex;align-items:center;justify-content:center;transition:border-color .4s,box-shadow .4s;}
.qc-ring.aligned{border-color:var(--g);box-shadow:0 0 40px rgba(34,197,94,.5);}
/* Cardinal marks */
.qc-card{position:absolute;font-size:12px;font-weight:800;color:var(--mt);font-family:'Nunito',sans-serif;}
.qc-n{top:8px;left:50%;transform:translateX(-50%);color:#ef4444;}
.qc-s{bottom:8px;left:50%;transform:translateX(-50%);}
.qc-e{right:10px;top:50%;transform:translateY(-50%);}
.qc-w{left:10px;top:50%;transform:translateY(-50%);}
/* Degree ticks */
.qc-ticks{position:absolute;inset:0;border-radius:50%;}

/* The arrow that points to qibla */
.qibla-arrow{position:absolute;top:50%;left:50%;transform-origin:center bottom;width:10px;height:90px;margin-left:-5px;margin-top:-90px;transition:transform 0.6s cubic-bezier(.34,1.56,.64,1);}
.qa-head{width:0;height:0;border-left:14px solid transparent;border-right:14px solid transparent;border-bottom:30px solid var(--gold);margin-left:-7px;filter:drop-shadow(0 0 8px rgba(212,168,67,.8));}
.qa-body{width:4px;height:60px;background:linear-gradient(var(--gold),rgba(212,168,67,.3));margin-left:3px;border-radius:0 0 4px 4px;}

/* Kaaba icon center */
.qc-center{width:48px;height:48px;border-radius:50%;background:radial-gradient(circle at 38% 32%,#42a5f5,#0d47a1);display:flex;align-items:center;justify-content:center;font-size:22px;box-shadow:0 0 0 3px rgba(255,255,255,.1),0 4px 16px rgba(0,0,0,.5);transition:box-shadow .4s;}
.qc-center.aligned{box-shadow:0 0 0 3px var(--g),0 0 20px rgba(34,197,94,.5);}

/* Qibla info */
.qibla-deg{text-align:center;margin-bottom:12px;}
.qdeg-val{font-family:'Nunito',sans-serif;font-size:48px;font-weight:800;line-height:1;color:var(--tx);}
.qdeg-dir{font-size:12px;color:var(--mt);letter-spacing:2px;font-weight:700;text-transform:uppercase;margin-top:4px;}
.qdeg-from{font-size:13px;color:var(--g);margin-top:6px;font-weight:600;}

/* Location */
.loc-row{display:flex;align-items:center;gap:10px;background:var(--s2);border-radius:12px;padding:10px 12px;}
.loc-ico{font-size:20px;flex-shrink:0;}
.loc-name{font-size:13px;font-weight:700;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;}
.loc-coord{font-size:10px;color:var(--mt);margin-top:2px;}

/* How to use */
.howto{width:100%;max-width:360px;background:rgba(34,197,94,.06);border:1px solid rgba(34,197,94,.2);border-radius:14px;padding:14px;margin-bottom:14px;}
.howto h3{font-size:13px;font-weight:700;color:var(--g);margin-bottom:8px;}
.howto-step{display:flex;gap:8px;margin-bottom:6px;font-size:12px;color:var(--mt);line-height:1.5;}
.howto-step:last-child{margin-bottom:0;}
.hwnum{width:20px;height:20px;border-radius:50%;background:rgba(34,197,94,.15);border:1px solid rgba(34,197,94,.3);display:flex;align-items:center;justify-content:center;font-size:10px;font-weight:800;color:var(--g);flex-shrink:0;}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   TAB 2 â€” QUR'ON
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
#pg1{display:flex;flex-direction:column;}
.qhdr{padding:12px 12px 8px;background:var(--s1);border-bottom:1px solid var(--bdr);position:sticky;top:0;z-index:10;flex-shrink:0;}
.qhdr-title{font-family:'Amiri',serif;font-size:20px;color:var(--gold);text-align:center;text-shadow:0 0 12px rgba(212,168,67,.3);margin-bottom:8px;}
.srch-box{position:relative;}
.srch-box input{width:100%;background:var(--s2);border:1.5px solid var(--bdr);border-radius:10px;padding:8px 12px 8px 34px;color:var(--tx);font-family:'Tajawal',sans-serif;font-size:13px;outline:none;}
.srch-box input:focus{border-color:var(--g);}
.srch-box input::placeholder{color:var(--mt);}
.srch-ico{position:absolute;left:10px;top:50%;transform:translateY(-50%);font-size:14px;pointer-events:none;}
.edi-row{display:flex;gap:5px;margin-top:7px;overflow-x:auto;padding-bottom:2px;}
.edi-row::-webkit-scrollbar{display:none;}
.echip{flex-shrink:0;padding:4px 10px;border-radius:16px;border:1.5px solid var(--bdr);background:var(--s2);color:var(--mt);font-size:11px;cursor:pointer;transition:all .2s;font-family:'Tajawal',sans-serif;white-space:nowrap;}
.echip.on{background:rgba(34,197,94,.15);border-color:var(--g);color:var(--g);}
.sura-list{padding:7px 10px 150px;}
.sura-item{display:flex;align-items:center;gap:9px;padding:9px 10px;border-radius:10px;background:var(--s1);border:1px solid var(--bdr);margin-bottom:4px;cursor:pointer;transition:background .15s;position:relative;overflow:hidden;}
.sura-item.pl{background:rgba(34,197,94,.1);border-color:var(--g);}
.sura-item::before{content:'';position:absolute;left:0;top:0;bottom:0;width:3px;background:var(--g);transform:scaleY(0);transition:transform .2s;border-radius:0 2px 2px 0;}
.sura-item.pl::before{transform:scaleY(1);}
.sno{width:30px;height:30px;background:var(--s2);border-radius:7px;display:flex;align-items:center;justify-content:center;font-size:10px;font-weight:700;color:var(--g);flex-shrink:0;border:1px solid var(--bdr);}
.sura-item.pl .sno{background:var(--g);color:#fff;border-color:var(--g);}
.sinf{flex:1;min-width:0;}
.sar{font-family:'Amiri',serif;font-size:15px;}
.suz{font-size:10px;color:var(--mt);margin-top:1px;}
.smeta{font-size:10px;color:var(--mt);text-align:right;flex-shrink:0;line-height:1.5;}
.spbtn{width:30px;height:30px;border-radius:50%;background:var(--s2);border:1px solid var(--bdr);display:flex;align-items:center;justify-content:center;font-size:11px;flex-shrink:0;}
.sura-item.pl .spbtn{background:var(--g);border-color:var(--g);}
.nores{text-align:center;padding:40px 20px;color:var(--mt);font-size:13px;}

/* Player */
.player{position:fixed;bottom:0;left:0;right:0;background:linear-gradient(0deg,#060c15,rgba(10,22,42,.98));border-top:1px solid var(--bdr);padding:10px 14px 18px;z-index:200;transform:translateY(100%);transition:transform .3s cubic-bezier(.4,0,.2,1);box-shadow:0 -6px 30px rgba(0,0,0,.6);}
.player.vis{transform:translateY(0);}
.p-info{display:flex;align-items:flex-start;justify-content:space-between;margin-bottom:6px;}
.p-title{font-family:'Amiri',serif;font-size:14px;color:var(--gold);}
.p-sub{font-size:10px;color:var(--mt);margin-top:2px;}
.p-cls{background:none;border:none;color:var(--mt);font-size:18px;cursor:pointer;padding:2px 6px;}
.p-row{display:flex;align-items:center;gap:8px;margin-bottom:7px;}
.p-tm{font-size:11px;color:var(--mt);min-width:30px;font-variant-numeric:tabular-nums;}
.p-bar{flex:1;height:4px;background:var(--s3);border-radius:4px;cursor:pointer;}
.p-fill{height:100%;background:var(--g);border-radius:4px;width:0%;transition:width .25s linear;pointer-events:none;}
.p-ctrls{display:flex;align-items:center;justify-content:center;gap:18px;}
.p-cbtn{background:none;border:none;color:var(--mt);font-size:20px;cursor:pointer;padding:4px;}
.p-pbtn{width:46px;height:46px;border-radius:50%;background:var(--g);border:none;display:flex;align-items:center;justify-content:center;font-size:20px;cursor:pointer;box-shadow:0 4px 14px var(--gw);transition:transform .1s;}
.p-pbtn:active{transform:scale(.92);}
.p-msg{font-size:10px;color:var(--mt);text-align:center;margin-top:5px;min-height:15px;}
.p-msg.err{color:#e74c3c;}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   TAB 3 â€” NAMOZ
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
#pg2{display:flex;flex-direction:column;}
.nhdr{padding:12px 12px 8px;background:var(--s1);border-bottom:1px solid var(--bdr);position:sticky;top:0;z-index:10;flex-shrink:0;}
.nhdr-title{font-family:'Amiri',serif;font-size:20px;color:var(--gold);text-align:center;text-shadow:0 0 12px rgba(212,168,67,.3);margin-bottom:8px;}
.ntabs{display:flex;gap:0;background:var(--s2);border-radius:10px;padding:3px;border:1px solid var(--bdr);}
.ntab{flex:1;padding:7px 4px;border:none;background:transparent;color:var(--mt);font-family:'Tajawal',sans-serif;font-size:11px;font-weight:600;cursor:pointer;border-radius:7px;transition:all .2s;text-align:center;white-space:nowrap;}
.ntab.on{background:var(--g);color:#fff;box-shadow:0 2px 10px rgba(34,197,94,.4);}
.ncontent{flex:1;overflow-y:auto;padding:12px 12px 24px;}

/* â”€â”€â”€ Namoz vaqtlari â”€â”€â”€ */
.ptimes-grid{display:grid;grid-template-columns:1fr 1fr 1fr;gap:8px;margin-bottom:14px;}
.pt-card{background:var(--s1);border:1px solid var(--bdr);border-radius:12px;padding:10px 8px;text-align:center;transition:all .3s;}
.pt-card.active{background:rgba(34,197,94,.12);border-color:var(--g);box-shadow:0 0 14px rgba(34,197,94,.2);}
.pt-ico{font-size:20px;margin-bottom:4px;}
.pt-name{font-size:11px;font-weight:700;color:var(--mt);margin-bottom:2px;}
.pt-card.active .pt-name{color:var(--g);}
.pt-time{font-family:'Nunito',sans-serif;font-size:16px;font-weight:800;color:var(--tx);}
.pt-card.active .pt-time{color:var(--g);}
.pt-next{font-size:10px;color:var(--mt);margin-top:2px;}
.pt-loc{text-align:center;font-size:11px;color:var(--mt);margin-bottom:12px;}
.pt-loc b{color:var(--tx);}

/* Date + clock */
.pt-header{background:var(--s1);border:1px solid var(--bdr);border-radius:14px;padding:12px;text-align:center;margin-bottom:12px;}
.pt-clock{font-family:'Nunito',sans-serif;font-size:36px;font-weight:800;color:var(--tx);line-height:1;}
.pt-date{font-size:12px;color:var(--mt);margin-top:4px;}

/* â”€â”€â”€ Tasbeh â”€â”€â”€ */
.tasbeh-wrap{text-align:center;}
.tasbeh-display{font-family:'Nunito',sans-serif;font-size:72px;font-weight:800;color:var(--g);line-height:1;margin-bottom:4px;text-shadow:0 0 30px rgba(34,197,94,.4);}
.tasbeh-label{font-family:'Amiri',serif;font-size:20px;color:var(--gold);margin-bottom:4px;}
.tasbeh-tr{font-size:12px;color:var(--mt);margin-bottom:20px;}
.tasbeh-btn{width:160px;height:160px;border-radius:50%;background:linear-gradient(135deg,var(--g),var(--gd));border:none;font-size:36px;cursor:pointer;box-shadow:0 8px 30px rgba(34,197,94,.5),inset 0 2px 0 rgba(255,255,255,.2);transition:transform .1s,box-shadow .1s;display:flex;align-items:center;justify-content:center;margin:0 auto 20px;}
.tasbeh-btn:active{transform:scale(.94);box-shadow:0 4px 15px rgba(34,197,94,.4);}
.tasbeh-targets{display:flex;gap:8px;justify-content:center;margin-bottom:16px;}
.tt-btn{padding:8px 16px;border-radius:20px;border:1.5px solid var(--bdr);background:var(--s2);color:var(--mt);font-family:'Tajawal',sans-serif;font-size:13px;font-weight:700;cursor:pointer;transition:all .2s;}
.tt-btn.on{background:rgba(34,197,94,.15);border-color:var(--g);color:var(--g);}
.tasbeh-zikrs{display:flex;flex-direction:column;gap:6px;}
.tz-item{background:var(--s1);border:1px solid var(--bdr);border-radius:10px;padding:10px 12px;cursor:pointer;transition:all .2s;}
.tz-item.on{border-color:var(--g);background:rgba(34,197,94,.08);}
.tz-ar{font-family:'Amiri',serif;font-size:17px;direction:rtl;color:var(--tx);margin-bottom:2px;}
.tz-uz{font-size:11px;color:var(--mt);}
.tasbeh-reset{margin-top:16px;padding:10px 24px;border-radius:20px;border:1px solid rgba(239,68,68,.3);background:transparent;color:#ef4444;font-family:'Tajawal',sans-serif;font-size:13px;cursor:pointer;}

/* â”€â”€â”€ Du'olar â”€â”€â”€ */
.dua-cats{display:flex;gap:5px;overflow-x:auto;margin-bottom:10px;padding-bottom:3px;}
.dua-cats::-webkit-scrollbar{display:none;}
.dcat{flex-shrink:0;padding:5px 12px;border-radius:16px;border:1.5px solid var(--bdr);background:var(--s2);color:var(--mt);font-size:11px;cursor:pointer;transition:all .2s;font-family:'Tajawal',sans-serif;white-space:nowrap;}
.dcat.on{background:rgba(34,197,94,.15);border-color:var(--g);color:var(--g);}
.dua-card{background:var(--s1);border:1px solid var(--bdr);border-radius:12px;padding:12px 14px;margin-bottom:8px;}
.dua-title{font-size:12px;font-weight:700;color:var(--g);margin-bottom:6px;}
.dua-ar{font-family:'Amiri',serif;font-size:19px;direction:rtl;text-align:center;color:#b8d0e8;line-height:1.7;margin-bottom:6px;padding:8px;background:rgba(0,0,0,.15);border-radius:8px;}
.dua-tr{font-size:11px;color:#3d6080;font-style:italic;margin-bottom:4px;}
.dua-uz{font-size:12px;color:var(--mt);line-height:1.6;}

/* â”€â”€â”€ Namoz o'rgatish â”€â”€â”€ */
.tahorat-step{background:var(--s1);border:1px solid var(--bdr);border-radius:12px;margin-bottom:8px;overflow:hidden;}
.ts-hd{display:flex;align-items:center;gap:9px;padding:11px 12px;cursor:pointer;}
.ts-num{width:28px;height:28px;border-radius:50%;background:rgba(34,197,94,.12);border:1.5px solid rgba(34,197,94,.3);display:flex;align-items:center;justify-content:center;font-size:11px;font-weight:800;color:var(--g);flex-shrink:0;}
.ts-ico{font-size:20px;}
.ts-ttl{flex:1;font-size:13px;font-weight:700;}
.ts-arr{color:var(--mt);font-size:12px;transition:transform .2s;}
.tahorat-step.open .ts-arr{transform:rotate(180deg);}
.ts-body{max-height:0;overflow:hidden;transition:max-height .3s ease;}
.tahorat-step.open .ts-body{max-height:500px;}
.ts-inner{padding:0 12px 12px;}
.ts-ar{font-family:'Amiri',serif;font-size:20px;direction:rtl;text-align:center;color:#b8d0e8;line-height:1.7;margin-bottom:6px;padding:8px;background:rgba(0,0,0,.15);border-radius:8px;}
.ts-tr{font-size:11px;color:#3d6080;font-style:italic;margin-bottom:4px;}
.ts-desc{font-size:12px;color:var(--mt);line-height:1.6;}

.prayer-card{background:var(--s1);border:1px solid var(--bdr);border-radius:14px;margin-bottom:10px;overflow:hidden;}
.pc-hd{display:flex;align-items:center;gap:10px;padding:13px 14px;cursor:pointer;}
.pc-ico{font-size:26px;}
.pc-info{flex:1;}
.pc-name{font-family:'Amiri',serif;font-size:17px;color:var(--gold);}
.pc-sub{font-size:10px;color:var(--mt);margin-top:1px;}
.pc-rakat{background:rgba(34,197,94,.1);border:1px solid rgba(34,197,94,.25);border-radius:16px;padding:3px 9px;font-size:10px;color:var(--g);font-weight:700;white-space:nowrap;}
.pc-arr{color:var(--mt);font-size:12px;transition:transform .2s;}
.prayer-card.open .pc-arr{transform:rotate(180deg);}
.pc-body{max-height:0;overflow:hidden;transition:max-height .4s ease;}
.prayer-card.open .pc-body{max-height:3000px;}
.pc-inner{padding:0 14px 14px;}
.pc-info-box{background:rgba(34,197,94,.05);border:1px solid rgba(34,197,94,.15);border-radius:8px;padding:8px 10px;margin-bottom:10px;font-size:12px;color:#3d6080;line-height:1.6;}
.rakat-step{display:flex;gap:8px;padding:8px 0;border-bottom:1px solid rgba(255,255,255,.04);}
.rakat-step:last-child{border-bottom:none;}
.rs-num{width:24px;height:24px;border-radius:50%;background:var(--s2);border:1px solid var(--bdr);display:flex;align-items:center;justify-content:center;font-size:10px;font-weight:800;color:var(--g);flex-shrink:0;margin-top:1px;}
.rs-cont{flex:1;}
.rs-ttl{font-size:12px;font-weight:700;color:var(--tx);margin-bottom:3px;}
.rs-ar{font-family:'Amiri',serif;font-size:16px;direction:rtl;color:#9ab8d0;line-height:1.6;margin-bottom:2px;}
.rs-tr{font-size:10px;color:#3d5e78;font-style:italic;margin-bottom:2px;}
.rs-uz{font-size:11px;color:var(--mt);line-height:1.5;}

.sec-label{font-family:'Amiri',serif;font-size:16px;color:var(--gold);text-align:center;margin:14px 0 8px;}
.info-box{background:rgba(34,197,94,.05);border:1px solid rgba(34,197,94,.15);border-radius:10px;padding:10px 12px;margin-bottom:10px;font-size:12px;color:#3d6080;line-height:1.6;}
.info-box b{color:var(--g);}
</style>
</head>
<body>
<div class="stars" id="stars"></div>

<nav>
  <button class="nb on" id="nb0" onclick="goTab(0)"><span class="ni">ğŸ§­</span><span>Qibla</span></button>
  <button class="nb" id="nb1" onclick="goTab(1)"><span class="ni">ğŸ“–</span><span>Qur'on</span></button>
  <button class="nb" id="nb2" onclick="goTab(2)"><span class="ni">ğŸ¤²</span><span>Namoz</span></button>
</nav>

<div class="pages">

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• TAB 1: QIBLA â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div class="pg on" id="pg0">
  <div class="qibla-card">
    <div class="qibla-title">ğŸ•‹ Qibla Yo'nalishi</div>
    <div class="qibla-compass">
      <div class="qc-ring" id="qcRing">
        <span class="qc-card qc-n">N</span>
        <span class="qc-card qc-s">S</span>
        <span class="qc-card qc-e">E</span>
        <span class="qc-card qc-w">W</span>
        <!-- Arrow pointing to qibla -->
        <div class="qibla-arrow" id="qiblaArrow">
          <div class="qa-head"></div>
          <div class="qa-body"></div>
        </div>
        <div class="qc-center" id="qcCenter">ğŸ•‹</div>
      </div>
    </div>
    <div class="qibla-deg">
      <div class="qdeg-val" id="qdegVal">--Â°</div>
      <div class="qdeg-dir" id="qdegDir">Aniqlanmoqda</div>
      <div class="qdeg-from" id="qdegFrom"></div>
    </div>
    <div class="loc-row">
      <div class="loc-ico">ğŸ“</div>
      <div style="flex:1;min-width:0;">
        <div class="loc-name" id="locName">Joylashuv aniqlanmoqda...</div>
        <div class="loc-coord" id="locCoord"></div>
      </div>
    </div>
  </div>

  <div class="howto" style="width:100%;max-width:360px;">
    <h3>ğŸ“± Qiblani qanday topish:</h3>
    <div class="howto-step"><div class="hwnum">1</div><span>Qurilmangizda <b>kompas ilovasi</b>ni oching</span></div>
    <div class="howto-step"><div class="hwnum">2</div><span>Qibla <b id="howDeg">--Â°</b> yo'nalishida â€” bu <b id="howDir">--</b> tomonga</span></div>
    <div class="howto-step"><div class="hwnum">3</div><span>Kompas <b id="howCard">--</b> harfiga qarating, so'ng <b id="howOff">--</b> burilasiz</span></div>
    <div class="howto-step"><div class="hwnum">4</div><span>Yoki pastdagi xaritada Makkaga qarab namoz o'qing</span></div>
  </div>

  <!-- Static visual map hint -->
  <div style="width:100%;max-width:360px;background:var(--s1);border:1px solid var(--bdr);border-radius:14px;padding:14px;text-align:center;">
    <div style="font-size:12px;color:var(--mt);margin-bottom:8px;">ğŸ“ Shahringizdan Makka tomoni</div>
    <canvas id="dirCanvas" width="320" height="120" style="width:100%;border-radius:8px;"></canvas>
  </div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• TAB 2: QUR'ON â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div class="pg" id="pg1">
  <div class="qhdr">
    <div class="qhdr-title">ğŸ“– Qur'oni Karim</div>
    <div class="srch-box"><span class="srch-ico">ğŸ”</span>
      <input id="srch" type="text" placeholder="Sura nomi yoki raqami..." oninput="doFilter()">
    </div>
    <div class="edi-row" id="ediRow"></div>
  </div>
  <div class="sura-list" id="suraList"></div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• TAB 3: NAMOZ â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div class="pg" id="pg2">
  <div class="nhdr">
    <div class="nhdr-title">ğŸ¤² Namoz</div>
    <div class="ntabs">
      <button class="ntab on" id="nt0" onclick="nTab(0)">â° Vaqtlar</button>
      <button class="ntab" id="nt1" onclick="nTab(1)">ğŸ“¿ Tasbeh</button>
      <button class="ntab" id="nt2" onclick="nTab(2)">ğŸ¤² Du'olar</button>
      <button class="ntab" id="nt3" onclick="nTab(3)">ğŸ•Œ O'rgatish</button>
    </div>
  </div>
  <div class="ncontent" id="ncontent"></div>
</div>

</div><!-- /pages -->

<!-- Audio Player -->
<div class="player" id="player">
  <div class="p-info">
    <div><div class="p-title" id="ptit">â€”</div><div class="p-sub" id="psub">â€”</div></div>
    <button class="p-cls" onclick="closePlayer()">âœ•</button>
  </div>
  <div class="p-row">
    <span class="p-tm" id="ptc">0:00</span>
    <div class="p-bar" id="pbar" onclick="seekA(event)"><div class="p-fill" id="pfil"></div></div>
    <span class="p-tm" id="ptd">--:--</span>
  </div>
  <div class="p-ctrls">
    <button class="p-cbtn" onclick="moveSurah(-1)">â®</button>
    <button class="p-pbtn" id="ppbtn" onclick="togglePlay()">â–¶</button>
    <button class="p-cbtn" onclick="moveSurah(1)">â­</button>
  </div>
  <div class="p-msg" id="pmsg"></div>
</div>
<audio id="au" preload="none"></audio>

<script>
'use strict';

/* â”€â”€ Stars â”€â”€ */
(()=>{const c=document.getElementById('stars');for(let i=0;i<60;i++){const s=document.createElement('div');s.className='star';const z=Math.random()<.2?3:Math.random()<.5?2:1;s.style.cssText=`width:${z}px;height:${z}px;left:${Math.random()*100}%;top:${Math.random()*100}%;--d:${2+Math.random()*5}s;--dl:-${Math.random()*8}s`;c.appendChild(s);}})();

/* â”€â”€ Tab navigation â”€â”€ */
function goTab(i){[0,1,2].forEach(j=>{document.getElementById('nb'+j).classList.toggle('on',j===i);document.getElementById('pg'+j).classList.toggle('on',j===i);});}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   TAB 1 â€” QIBLA (kompas sensorsiz)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
const KA_LAT=21.4225,KA_LON=39.8262;
let uLat=41.2995,uLon=69.2401,qiblaAngle=0;

function calcQibla(lat,lon){
  const toR=d=>d*Math.PI/180,fromR=r=>r*180/Math.PI;
  const Ï†1=toR(lat),Ï†2=toR(KA_LAT),Î”Î»=toR(KA_LON-lon);
  const y=Math.sin(Î”Î»)*Math.cos(Ï†2);
  const x=Math.cos(Ï†1)*Math.sin(Ï†2)-Math.sin(Ï†1)*Math.cos(Ï†2)*Math.cos(Î”Î»);
  return norm(fromR(Math.atan2(y,x)));
}
function norm(a){return((a%360)+360)%360;}
function cardName(deg){return['Shimol (N)','Shim-Sharq (NE)','Sharq (E)','Jan-Sharq (SE)','Janub (S)','Jan-G\'arb (SW)','G\'arb (W)','Shim-G\'arb (NW)'][Math.round(norm(deg)/45)%8];}
function cardShort(deg){return['N','NE','E','SE','S','SW','W','NW'][Math.round(norm(deg)/45)%8];}

function updateQiblaUI(){
  qiblaAngle=calcQibla(uLat,uLon);
  const deg=Math.round(qiblaAngle);

  // Rotate arrow â€” arrow points UP by default (North), rotate to face qibla
  document.getElementById('qiblaArrow').style.transform=`rotate(${qiblaAngle}deg)`;
  document.getElementById('qdegVal').textContent=deg+'Â°';
  document.getElementById('qdegDir').textContent=cardName(qiblaAngle);
  document.getElementById('qdegFrom').textContent=`Shimol (N) dan ${deg}Â° o'ngga`;

  // How-to text
  document.getElementById('howDeg').textContent=deg+'Â°';
  document.getElementById('howDir').textContent=cardName(qiblaAngle);
  document.getElementById('howCard').textContent=cardShort(qiblaAngle);

  // Off angle instruction
  const base=Math.floor(qiblaAngle/45)*45;
  const baseCard=cardShort(base);
  const diff=Math.round(qiblaAngle-base);
  document.getElementById('howOff').textContent=diff>0?`${baseCard} dan ${diff}Â° o'ngga`:baseCard+' tomon';

  drawDirectionMap();
}

function drawDirectionMap(){
  const cv=document.getElementById('dirCanvas');
  const ctx=cv.getContext('2d');
  const W=cv.width,H=cv.height;
  ctx.clearRect(0,0,W,H);

  // Background
  const grad=ctx.createLinearGradient(0,0,0,H);
  grad.addColorStop(0,'#0b1a2e');grad.addColorStop(1,'#070d17');
  ctx.fillStyle=grad;ctx.fillRect(0,0,W,H);

  // Grid lines
  ctx.strokeStyle='rgba(255,255,255,.05)';ctx.lineWidth=1;
  for(let i=0;i<W;i+=32){ctx.beginPath();ctx.moveTo(i,0);ctx.lineTo(i,H);ctx.stroke();}
  for(let i=0;i<H;i+=32){ctx.beginPath();ctx.moveTo(0,i);ctx.lineTo(W,i);ctx.stroke();}

  const cx=80,cy=H/2;
  // Your location dot
  ctx.beginPath();ctx.arc(cx,cy,8,0,Math.PI*2);
  ctx.fillStyle='#22c55e';ctx.fill();
  ctx.shadowColor='#22c55e';ctx.shadowBlur=12;ctx.fill();ctx.shadowBlur=0;
  ctx.fillStyle='rgba(255,255,255,.7)';ctx.font='bold 10px Nunito,sans-serif';ctx.textAlign='center';
  ctx.fillText('Siz',cx,cy-14);

  // Direction line to Mecca
  const ang=qiblaAngle*Math.PI/180;
  const len=200;
  const ex=cx+Math.sin(ang)*len,ey=cy-Math.cos(ang)*len;

  // Gradient line
  const lg=ctx.createLinearGradient(cx,cy,ex,ey);
  lg.addColorStop(0,'rgba(212,168,67,.9)');lg.addColorStop(1,'rgba(212,168,67,.1)');
  ctx.beginPath();ctx.moveTo(cx,cy);ctx.lineTo(ex,ey);
  ctx.strokeStyle=lg;ctx.lineWidth=2.5;ctx.setLineDash([6,4]);ctx.stroke();ctx.setLineDash([]);

  // Mecca icon at end (clipped to canvas)
  const mx=Math.max(10,Math.min(W-10,ex)),my=Math.max(10,Math.min(H-10,ey));
  ctx.font='22px serif';ctx.textAlign='center';ctx.textBaseline='middle';
  ctx.fillText('ğŸ•‹',mx,my);

  // Degree label
  ctx.fillStyle='rgba(212,168,67,.85)';ctx.font='bold 11px Nunito,sans-serif';ctx.textAlign='left';ctx.textBaseline='top';
  ctx.fillText(`Makka â€” ${Math.round(qiblaAngle)}Â° (${cardShort(qiblaAngle)})`,cx+12,4);

  // Compass rose (small)
  const rx=W-36,ry=H-36,rr=22;
  ctx.fillStyle='rgba(11,26,46,.8)';ctx.beginPath();ctx.arc(rx,ry,rr,0,Math.PI*2);ctx.fill();
  ctx.strokeStyle='rgba(34,197,94,.3)';ctx.lineWidth=1;ctx.stroke();
  [['N',0,'#ef4444'],['E',90,'#6b7685'],['S',180,'#6b7685'],['W',270,'#6b7685']].forEach(([l,a,c])=>{
    const r=a*Math.PI/180;
    ctx.fillStyle=c;ctx.font='bold 9px Nunito';ctx.textAlign='center';ctx.textBaseline='middle';
    ctx.fillText(l,rx+Math.sin(r)*(rr-7),ry-Math.cos(r)*(rr-7));
  });
}

/* â”€â”€ Location: GPS â†’ IP â†’ Toshkent â”€â”€ */
function setLoc(lat,lon,name){
  uLat=lat;uLon=lon;
  document.getElementById('locName').textContent=name;
  document.getElementById('locCoord').textContent=`${lat.toFixed(4)}Â°N, ${lon.toFixed(4)}Â°E`;
  updateQiblaUI();
  loadPrayerTimes(lat,lon);
}
function startGPS(){
  if(!navigator.geolocation){startIPGeo();return;}
  navigator.geolocation.getCurrentPosition(pos=>{
    const {latitude:la,longitude:lo}=pos.coords;
    reverseGeo(la,lo);
  },()=>startIPGeo(),{enableHighAccuracy:true,timeout:10000,maximumAge:0});
}
function startIPGeo(){
  fetch('https://ip-api.com/json/?fields=status,lat,lon,city,country')
    .then(r=>r.json()).then(d=>{
      if(d.status==='success')setLoc(d.lat,d.lon,(d.city||'')+(d.country?', '+d.country:''));
      else setLoc(41.2995,69.2401,"Toshkent, O'zbekiston");
    }).catch(()=>setLoc(41.2995,69.2401,"Toshkent, O'zbekiston"));
}
function reverseGeo(lat,lon){
  document.getElementById('locName').textContent='Aniqlanmoqda...';
  fetch(`https://nominatim.openstreetmap.org/reverse?lat=${lat}&lon=${lon}&format=json&accept-language=uz,en`)
    .then(r=>r.json()).then(d=>{
      const a=d.address||{};const city=a.city||a.town||a.village||a.state||'';const country=a.country||'';
      setLoc(lat,lon,city&&country?`${city}, ${country}`:city||`${lat.toFixed(3)}Â°N`);
    }).catch(()=>setLoc(lat,lon,`${lat.toFixed(4)}Â°N, ${lon.toFixed(4)}Â°E`));
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   TAB 2 â€” QUR'ON AUDIO
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
const EDITIONS=[{name:'Mishary Alafasy',ed:'ar.alafasy'},{name:'Sudais',ed:'ar.abdurrahmaansudais'},{name:'Husary',ed:'ar.husary'},{name:'Saad Ghamdi',ed:'ar.saoodshuraym'}];
const SURAHS=[
  {n:1,ar:'Ø§Ù„ÙØ§ØªØ­Ø©',uz:'Al-Fotiha',a:7,t:'Makka'},{n:2,ar:'Ø§Ù„Ø¨Ù‚Ø±Ø©',uz:'Al-Baqara',a:286,t:'Madina'},
  {n:3,ar:'Ø¢Ù„ Ø¹Ù…Ø±Ø§Ù†',uz:'Ali Imron',a:200,t:'Madina'},{n:4,ar:'Ø§Ù„Ù†Ø³Ø§Ø¡',uz:'An-Niso',a:176,t:'Madina'},
  {n:5,ar:'Ø§Ù„Ù…Ø§Ø¦Ø¯Ø©',uz:'Al-Moida',a:120,t:'Madina'},{n:6,ar:'Ø§Ù„Ø£Ù†Ø¹Ø§Ù…',uz:"Al-An'om",a:165,t:'Makka'},
  {n:7,ar:'Ø§Ù„Ø£Ø¹Ø±Ø§Ù',uz:"Al-A'rof",a:206,t:'Makka'},{n:8,ar:'Ø§Ù„Ø£Ù†ÙØ§Ù„',uz:'Al-Anfol',a:75,t:'Madina'},
  {n:9,ar:'Ø§Ù„ØªÙˆØ¨Ø©',uz:'At-Tavba',a:129,t:'Madina'},{n:10,ar:'ÙŠÙˆÙ†Ø³',uz:'Yunus',a:109,t:'Makka'},
  {n:11,ar:'Ù‡ÙˆØ¯',uz:'Hud',a:123,t:'Makka'},{n:12,ar:'ÙŠÙˆØ³Ù',uz:'Yusuf',a:111,t:'Makka'},
  {n:13,ar:'Ø§Ù„Ø±Ø¹Ø¯',uz:"Ar-Ra'd",a:43,t:'Madina'},{n:14,ar:'Ø¥Ø¨Ø±Ø§Ù‡ÙŠÙ…',uz:'Ibrohim',a:52,t:'Makka'},
  {n:15,ar:'Ø§Ù„Ø­Ø¬Ø±',uz:'Al-Hijr',a:99,t:'Makka'},{n:16,ar:'Ø§Ù„Ù†Ø­Ù„',uz:'An-Nahl',a:128,t:'Makka'},
  {n:17,ar:'Ø§Ù„Ø¥Ø³Ø±Ø§Ø¡',uz:'Al-Isro',a:111,t:'Makka'},{n:18,ar:'Ø§Ù„ÙƒÙ‡Ù',uz:'Al-Kahf',a:110,t:'Makka'},
  {n:19,ar:'Ù…Ø±ÙŠÙ…',uz:'Maryam',a:98,t:'Makka'},{n:20,ar:'Ø·Ù‡',uz:'To Ha',a:135,t:'Makka'},
  {n:21,ar:'Ø§Ù„Ø£Ù†Ø¨ÙŠØ§Ø¡',uz:'Al-Anbiyo',a:112,t:'Makka'},{n:22,ar:'Ø§Ù„Ø­Ø¬',uz:'Al-Haj',a:78,t:'Madina'},
  {n:23,ar:'Ø§Ù„Ù…Ø¤Ù…Ù†ÙˆÙ†',uz:"Al-Mo'minun",a:118,t:'Makka'},{n:24,ar:'Ø§Ù„Ù†ÙˆØ±',uz:'An-Nur',a:64,t:'Madina'},
  {n:25,ar:'Ø§Ù„ÙØ±Ù‚Ø§Ù†',uz:'Al-Furqon',a:77,t:'Makka'},{n:26,ar:'Ø§Ù„Ø´Ø¹Ø±Ø§Ø¡',uz:"Ash-Shu'aro",a:227,t:'Makka'},
  {n:27,ar:'Ø§Ù„Ù†Ù…Ù„',uz:'An-Naml',a:93,t:'Makka'},{n:28,ar:'Ø§Ù„Ù‚ØµØµ',uz:'Al-Qasas',a:88,t:'Makka'},
  {n:29,ar:'Ø§Ù„Ø¹Ù†ÙƒØ¨ÙˆØª',uz:'Al-Ankabut',a:69,t:'Makka'},{n:30,ar:'Ø§Ù„Ø±ÙˆÙ…',uz:'Ar-Rum',a:60,t:'Makka'},
  {n:31,ar:'Ù„Ù‚Ù…Ø§Ù†',uz:'Luqmon',a:34,t:'Makka'},{n:32,ar:'Ø§Ù„Ø³Ø¬Ø¯Ø©',uz:'As-Sajda',a:30,t:'Makka'},
  {n:33,ar:'Ø§Ù„Ø£Ø­Ø²Ø§Ø¨',uz:'Al-Ahzob',a:73,t:'Madina'},{n:34,ar:'Ø³Ø¨Ø£',uz:'Saba',a:54,t:'Makka'},
  {n:35,ar:'ÙØ§Ø·Ø±',uz:'Fotir',a:45,t:'Makka'},{n:36,ar:'ÙŠØ³',uz:'Yo Sin',a:83,t:'Makka'},
  {n:37,ar:'Ø§Ù„ØµØ§ÙØ§Øª',uz:'As-Soffot',a:182,t:'Makka'},{n:38,ar:'Øµ',uz:'Sod',a:88,t:'Makka'},
  {n:39,ar:'Ø§Ù„Ø²Ù…Ø±',uz:'Az-Zumar',a:75,t:'Makka'},{n:40,ar:'ØºØ§ÙØ±',uz:"G'ofir",a:85,t:'Makka'},
  {n:41,ar:'ÙØµÙ„Øª',uz:'Fussilat',a:54,t:'Makka'},{n:42,ar:'Ø§Ù„Ø´ÙˆØ±Ù‰',uz:'Ash-Shura',a:53,t:'Makka'},
  {n:43,ar:'Ø§Ù„Ø²Ø®Ø±Ù',uz:'Az-Zukhruf',a:89,t:'Makka'},{n:44,ar:'Ø§Ù„Ø¯Ø®Ø§Ù†',uz:'Ad-Dukhan',a:59,t:'Makka'},
  {n:45,ar:'Ø§Ù„Ø¬Ø§Ø«ÙŠØ©',uz:'Al-Josiya',a:37,t:'Makka'},{n:46,ar:'Ø§Ù„Ø£Ø­Ù‚Ø§Ù',uz:'Al-Ahqof',a:35,t:'Makka'},
  {n:47,ar:'Ù…Ø­Ù…Ø¯',uz:'Muhammad',a:38,t:'Madina'},{n:48,ar:'Ø§Ù„ÙØªØ­',uz:'Al-Fath',a:29,t:'Madina'},
  {n:49,ar:'Ø§Ù„Ø­Ø¬Ø±Ø§Øª',uz:'Al-Hujurot',a:18,t:'Madina'},{n:50,ar:'Ù‚',uz:'Qof',a:45,t:'Makka'},
  {n:51,ar:'Ø§Ù„Ø°Ø§Ø±ÙŠØ§Øª',uz:'Az-Zoriyot',a:60,t:'Makka'},{n:52,ar:'Ø§Ù„Ø·ÙˆØ±',uz:'At-Tur',a:49,t:'Makka'},
  {n:53,ar:'Ø§Ù„Ù†Ø¬Ù…',uz:'An-Najm',a:62,t:'Makka'},{n:54,ar:'Ø§Ù„Ù‚Ù…Ø±',uz:'Al-Qamar',a:55,t:'Makka'},
  {n:55,ar:'Ø§Ù„Ø±Ø­Ù…Ù†',uz:'Ar-Rohman',a:78,t:'Madina'},{n:56,ar:'Ø§Ù„ÙˆØ§Ù‚Ø¹Ø©',uz:'Al-Voqia',a:96,t:'Makka'},
  {n:57,ar:'Ø§Ù„Ø­Ø¯ÙŠØ¯',uz:'Al-Hadid',a:29,t:'Madina'},{n:58,ar:'Ø§Ù„Ù…Ø¬Ø§Ø¯Ù„Ø©',uz:'Al-Mujodala',a:22,t:'Madina'},
  {n:59,ar:'Ø§Ù„Ø­Ø´Ø±',uz:'Al-Hashr',a:24,t:'Madina'},{n:60,ar:'Ø§Ù„Ù…Ù…ØªØ­Ù†Ø©',uz:'Al-Mumtahana',a:13,t:'Madina'},
  {n:61,ar:'Ø§Ù„ØµÙ',uz:'As-Saff',a:14,t:'Madina'},{n:62,ar:'Ø§Ù„Ø¬Ù…Ø¹Ø©',uz:"Al-Jum'a",a:11,t:'Madina'},
  {n:63,ar:'Ø§Ù„Ù…Ù†Ø§ÙÙ‚ÙˆÙ†',uz:'Al-Munofiqun',a:11,t:'Madina'},{n:64,ar:'Ø§Ù„ØªØºØ§Ø¨Ù†',uz:'At-Taghabun',a:18,t:'Madina'},
  {n:65,ar:'Ø§Ù„Ø·Ù„Ø§Ù‚',uz:'At-Talaq',a:12,t:'Madina'},{n:66,ar:'Ø§Ù„ØªØ­Ø±ÙŠÙ…',uz:'At-Tahrim',a:12,t:'Madina'},
  {n:67,ar:'Ø§Ù„Ù…Ù„Ùƒ',uz:'Al-Mulk',a:30,t:'Makka'},{n:68,ar:'Ø§Ù„Ù‚Ù„Ù…',uz:'Al-Qalam',a:52,t:'Makka'},
  {n:69,ar:'Ø§Ù„Ø­Ø§Ù‚Ø©',uz:'Al-Haqqa',a:52,t:'Makka'},{n:70,ar:'Ø§Ù„Ù…Ø¹Ø§Ø±Ø¬',uz:"Al-Ma'orij",a:44,t:'Makka'},
  {n:71,ar:'Ù†ÙˆØ­',uz:'Nuh',a:28,t:'Makka'},{n:72,ar:'Ø§Ù„Ø¬Ù†',uz:'Al-Jin',a:28,t:'Makka'},
  {n:73,ar:'Ø§Ù„Ù…Ø²Ù…Ù„',uz:'Al-Muzzammil',a:20,t:'Makka'},{n:74,ar:'Ø§Ù„Ù…Ø¯Ø«Ø±',uz:'Al-Muddaththir',a:56,t:'Makka'},
  {n:75,ar:'Ø§Ù„Ù‚ÙŠØ§Ù…Ø©',uz:'Al-Qiyoma',a:40,t:'Makka'},{n:76,ar:'Ø§Ù„Ø¥Ù†Ø³Ø§Ù†',uz:'Al-Inson',a:31,t:'Madina'},
  {n:77,ar:'Ø§Ù„Ù…Ø±Ø³Ù„Ø§Øª',uz:'Al-Mursalot',a:50,t:'Makka'},{n:78,ar:'Ø§Ù„Ù†Ø¨Ø£',uz:'An-Naba',a:40,t:'Makka'},
  {n:79,ar:'Ø§Ù„Ù†Ø§Ø²Ø¹Ø§Øª',uz:"An-Nozi'ot",a:46,t:'Makka'},{n:80,ar:'Ø¹Ø¨Ø³',uz:'Abasa',a:42,t:'Makka'},
  {n:81,ar:'Ø§Ù„ØªÙƒÙˆÙŠØ±',uz:'At-Takwir',a:29,t:'Makka'},{n:82,ar:'Ø§Ù„Ø§Ù†ÙØ·Ø§Ø±',uz:'Al-Infitor',a:19,t:'Makka'},
  {n:83,ar:'Ø§Ù„Ù…Ø·ÙÙÙŠÙ†',uz:'Al-Mutaffifin',a:36,t:'Makka'},{n:84,ar:'Ø§Ù„Ø§Ù†Ø´Ù‚Ø§Ù‚',uz:'Al-Inshiqoq',a:25,t:'Makka'},
  {n:85,ar:'Ø§Ù„Ø¨Ø±ÙˆØ¬',uz:'Al-Buruj',a:22,t:'Makka'},{n:86,ar:'Ø§Ù„Ø·Ø§Ø±Ù‚',uz:'At-Toriq',a:17,t:'Makka'},
  {n:87,ar:'Ø§Ù„Ø£Ø¹Ù„Ù‰',uz:"Al-A'lo",a:19,t:'Makka'},{n:88,ar:'Ø§Ù„ØºØ§Ø´ÙŠØ©',uz:"Al-G'oshiya",a:26,t:'Makka'},
  {n:89,ar:'Ø§Ù„ÙØ¬Ø±',uz:'Al-Fajr',a:30,t:'Makka'},{n:90,ar:'Ø§Ù„Ø¨Ù„Ø¯',uz:'Al-Balad',a:20,t:'Makka'},
  {n:91,ar:'Ø§Ù„Ø´Ù…Ø³',uz:'Ash-Shams',a:15,t:'Makka'},{n:92,ar:'Ø§Ù„Ù„ÙŠÙ„',uz:'Al-Layl',a:21,t:'Makka'},
  {n:93,ar:'Ø§Ù„Ø¶Ø­Ù‰',uz:'Ad-Duho',a:11,t:'Makka'},{n:94,ar:'Ø§Ù„Ø´Ø±Ø­',uz:'Ash-Sharh',a:8,t:'Makka'},
  {n:95,ar:'Ø§Ù„ØªÙŠÙ†',uz:'At-Tin',a:8,t:'Makka'},{n:96,ar:'Ø§Ù„Ø¹Ù„Ù‚',uz:'Al-Alaq',a:19,t:'Makka'},
  {n:97,ar:'Ø§Ù„Ù‚Ø¯Ø±',uz:'Al-Qadr',a:5,t:'Makka'},{n:98,ar:'Ø§Ù„Ø¨ÙŠÙ†Ø©',uz:'Al-Bayyina',a:8,t:'Madina'},
  {n:99,ar:'Ø§Ù„Ø²Ù„Ø²Ù„Ø©',uz:'Az-Zalzala',a:8,t:'Madina'},{n:100,ar:'Ø§Ù„Ø¹Ø§Ø¯ÙŠØ§Øª',uz:'Al-Odiyot',a:11,t:'Makka'},
  {n:101,ar:'Ø§Ù„Ù‚Ø§Ø±Ø¹Ø©',uz:"Al-Qori'a",a:11,t:'Makka'},{n:102,ar:'Ø§Ù„ØªÙƒØ§Ø«Ø±',uz:'At-Takosur',a:8,t:'Makka'},
  {n:103,ar:'Ø§Ù„Ø¹ØµØ±',uz:'Al-Asr',a:3,t:'Makka'},{n:104,ar:'Ø§Ù„Ù‡Ù…Ø²Ø©',uz:'Al-Humaza',a:9,t:'Makka'},
  {n:105,ar:'Ø§Ù„ÙÙŠÙ„',uz:'Al-Fil',a:5,t:'Makka'},{n:106,ar:'Ù‚Ø±ÙŠØ´',uz:'Quraysh',a:4,t:'Makka'},
  {n:107,ar:'Ø§Ù„Ù…Ø§Ø¹ÙˆÙ†',uz:"Al-Mo'un",a:7,t:'Makka'},{n:108,ar:'Ø§Ù„ÙƒÙˆØ«Ø±',uz:'Al-Kavshar',a:3,t:'Makka'},
  {n:109,ar:'Ø§Ù„ÙƒØ§ÙØ±ÙˆÙ†',uz:'Al-Kofirun',a:6,t:'Makka'},{n:110,ar:'Ø§Ù„Ù†ØµØ±',uz:'An-Nasr',a:3,t:'Madina'},
  {n:111,ar:'Ø§Ù„Ù…Ø³Ø¯',uz:'Al-Masad',a:5,t:'Makka'},{n:112,ar:'Ø§Ù„Ø¥Ø®Ù„Ø§Øµ',uz:'Al-Ikhlos',a:4,t:'Makka'},
  {n:113,ar:'Ø§Ù„ÙÙ„Ù‚',uz:'Al-Falaq',a:5,t:'Makka'},{n:114,ar:'Ø§Ù„Ù†Ø§Ø³',uz:'An-Nos',a:6,t:'Makka'},
];

const au=document.getElementById('au');
let edIdx=0,curIdx=null,ayahUrls=[],ayahIdx=0,playing=false,busy=false,filtered=[...SURAHS];
const aCache={};

function fmtT(s){if(!isFinite(s)||isNaN(s))return'0:00';return`${Math.floor(s/60)}:${String(Math.floor(s%60)).padStart(2,'0')}`;}
function setMsg(t,e=false){const el=document.getElementById('pmsg');el.textContent=t;el.className='p-msg'+(e?' err':'');}
function setPP(i){document.getElementById('ppbtn').textContent=i;}

async function loadSurah(idx,auto=true){
  if(busy)return;curIdx=idx;ayahIdx=0;ayahUrls=[];playing=false;busy=true;
  const s=SURAHS[idx],ed=EDITIONS[edIdx];
  document.getElementById('ptit').textContent=`${s.n}. ${s.ar} â€” ${s.uz}`;
  document.getElementById('psub').textContent=ed.name;
  document.getElementById('player').classList.add('vis');
  document.getElementById('pfil').style.width='0%';document.getElementById('ptc').textContent='0:00';document.getElementById('ptd').textContent='--:--';
  setPP('â³');setMsg(`${s.uz} yuklanmoqda...`);renderSuras(filtered);
  try{
    const k=`${s.n}|${ed.ed}`;
    if(!aCache[k]){const r=await fetch(`https://api.alquran.cloud/v1/surah/${s.n}/${ed.ed}`);const j=await r.json();if(j.code!==200)throw new Error('API xato');aCache[k]=j.data.ayahs.map(a=>a.audio);}
    ayahUrls=aCache[`${s.n}|${ed.ed}`];busy=false;setMsg(`${ayahUrls.length} oyat | ${ed.name}`);playAyah(0,auto);
  }catch(e){busy=false;setPP('â–¶');setMsg('âŒ '+e.message,true);renderSuras(filtered);}
}
function playAyah(idx,auto=true){
  if(idx>=ayahUrls.length){moveSurah(1);return;}
  ayahIdx=idx;au.src=ayahUrls[idx];au.load();setMsg(`${idx+1}/${ayahUrls.length} â€” oyat`);
  if(auto){au.play().then(()=>{playing=true;setPP('â¸');renderSuras(filtered);}).catch(e=>{setPP('â–¶');setMsg('âŒ '+e.message,true);});}else setPP('â–¶');
}
function togglePlay(){if(curIdx===null||busy)return;if(playing){au.pause();}else{if(!au.src){playAyah(ayahIdx,true);return;}au.play().then(()=>{playing=true;setPP('â¸');}).catch(e=>setMsg('âŒ '+e.message,true));}}
function moveSurah(d){if(curIdx===null)return;loadSurah((curIdx+d+SURAHS.length)%SURAHS.length,true);}
function closePlayer(){au.pause();playing=false;curIdx=null;ayahUrls=[];document.getElementById('player').classList.remove('vis');renderSuras(filtered);}
function seekA(e){if(!au.duration)return;const r=document.getElementById('pbar').getBoundingClientRect();au.currentTime=((e.clientX-r.left)/r.width)*au.duration;}
au.addEventListener('playing',()=>{playing=true;setPP('â¸');renderSuras(filtered);});
au.addEventListener('pause',()=>{playing=false;setPP('â–¶');renderSuras(filtered);});
au.addEventListener('ended',()=>playAyah(ayahIdx+1,true));
au.addEventListener('timeupdate',()=>{if(!au.duration)return;document.getElementById('pfil').style.width=(au.currentTime/au.duration*100)+'%';document.getElementById('ptc').textContent=fmtT(au.currentTime);});
au.addEventListener('durationchange',()=>document.getElementById('ptd').textContent=fmtT(au.duration));
au.addEventListener('error',()=>{setMsg(`Oyat xato, keyingisi...`,true);setTimeout(()=>playAyah(ayahIdx+1,true),600);});

function buildEditions(){
  const row=document.getElementById('ediRow');
  EDITIONS.forEach((e,i)=>{const b=document.createElement('button');b.className='echip'+(i===0?' on':'');b.textContent=e.name;b.onclick=()=>{edIdx=i;document.querySelectorAll('.echip').forEach((c,j)=>c.classList.toggle('on',j===i));if(curIdx!==null)loadSurah(curIdx,playing);};row.appendChild(b);});
}
function renderSuras(list){
  const el=document.getElementById('suraList');
  if(!list.length){el.innerHTML='<div class="nores">ğŸ” Hech narsa topilmadi</div>';return;}
  el.innerHTML='';
  list.forEach(s=>{
    const idx=s.n-1,isCur=curIdx===idx;
    const d=document.createElement('div');d.className='sura-item'+(isCur?' pl':'');
    d.innerHTML=`<div class="sno">${s.n}</div><div class="sinf"><div class="sar">${s.ar}</div><div class="suz">${s.uz}</div></div><div class="smeta">${s.a} oyat<br><small>${s.t}</small></div><div class="spbtn">${isCur&&playing?'â¸':'â–¶'}</div>`;
    d.onclick=()=>{if(curIdx===idx&&!busy)togglePlay();else loadSurah(idx,true);};el.appendChild(d);
  });
}
function doFilter(){const q=document.getElementById('srch').value.toLowerCase().trim();filtered=q?SURAHS.filter(s=>s.uz.toLowerCase().includes(q)||s.ar.includes(q)||String(s.n).includes(q)):[...SURAHS];renderSuras(filtered);}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   TAB 3 â€” NAMOZ
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */

/* â”€â”€â”€ Namoz vaqtlari (Aladhan API) â”€â”€â”€ */
let prayerData=null;
const PNAMES=[
  {key:'Fajr',uz:'Bomdod',ico:'ğŸŒ…'},
  {key:'Sunrise',uz:'Quyosh chiqishi',ico:'â˜€ï¸'},
  {key:'Dhuhr',uz:'Peshin',ico:'ğŸŒ¤ï¸'},
  {key:'Asr',uz:'Asr',ico:'ğŸŒ‡'},
  {key:'Maghrib',uz:'Shom',ico:'ğŸŒ†'},
  {key:'Isha',uz:'Xufton',ico:'ğŸŒ™'},
];

function loadPrayerTimes(lat,lon){
  const today=new Date();
  const d=today.getDate(),m=today.getMonth()+1,y=today.getFullYear();
  fetch(`https://api.aladhan.com/v1/timings/${d}-${m}-${y}?latitude=${lat}&longitude=${lon}&method=2`)
    .then(r=>r.json()).then(data=>{
      if(data.code===200){prayerData=data.data.timings;if(activeNTab===0)renderNTab();}
    }).catch(()=>{});
}

function getCurrentPrayer(){
  if(!prayerData)return -1;
  const now=new Date();
  const nowMin=now.getHours()*60+now.getMinutes();
  const keys=['Fajr','Dhuhr','Asr','Maghrib','Isha'];
  let cur=-1;
  keys.forEach((k,i)=>{
    const[hh,mm]=prayerData[k].split(':').map(Number);
    if(nowMin>=hh*60+mm)cur=i;
  });
  return cur;
}

function timeToMin(t){const[h,m]=t.split(':').map(Number);return h*60+m;}
function nextPrayer(){
  if(!prayerData)return null;
  const now=new Date();const nowM=now.getHours()*60+now.getMinutes();
  const keys=['Fajr','Sunrise','Dhuhr','Asr','Maghrib','Isha'];
  for(const k of keys){if(timeToMin(prayerData[k])>nowM)return k;}
  return 'Fajr';
}

/* â”€â”€â”€ Tasbeh â”€â”€â”€ */
let tasbehCount=0,tasbehTarget=33;
const ZIKRS=[
  {ar:'Ø³ÙØ¨Ù’Ø­ÙØ§Ù†Ù Ø§Ù„Ù„Ù‡Ù',uz:'Alloh pokdir â€” Subhanalloh',n:33},
  {ar:'Ø§Ù„Ù’Ø­ÙÙ…Ù’Ø¯Ù Ù„ÙÙ„ÙÙ‘Ù‡Ù',uz:'Allohga hamd â€” Alhamdulillah',n:33},
  {ar:'Ø§Ù„Ù„Ù‡Ù Ø£ÙÙƒÙ’Ø¨ÙØ±Ù',uz:'Alloh buyuk â€” Allahu Akbar',n:33},
  {ar:'Ù„ÙØ§ Ø¥ÙÙ„ÙÙ‡Ù Ø¥ÙÙ„ÙÙ‘Ø§ Ø§Ù„Ù„Ù‡Ù',uz:'Allohdan boshqa iloh yo\'q â€” La ilaha illalloh',n:100},
  {ar:'Ø£ÙØ³Ù’ØªÙØºÙ’ÙÙØ±Ù Ø§Ù„Ù„Ù‡Ù',uz:'Allohdan kechim so\'rayman â€” Astagfirulloh',n:100},
];
let activeZikr=0;

/* â”€â”€â”€ Du'olar â”€â”€â”€ */
const DUA_CATS=['Kundalik','Namozdan keyin','Uxlash','Ovqat','Safar','Tahorat'];
const DUAS={
  'Kundalik':[
    {title:'Ertalab uyg\'onishda',ar:'Ø§Ù„Ù’Ø­ÙÙ…Ù’Ø¯Ù Ù„ÙÙ„ÙÙ‘Ù‡Ù Ø§Ù„ÙÙ‘Ø°ÙÙŠ Ø£ÙØ­Ù’ÙŠÙØ§Ù†ÙØ§ Ø¨ÙØ¹Ù’Ø¯Ù Ù…ÙØ§ Ø£ÙÙ…ÙØ§ØªÙÙ†ÙØ§ ÙˆÙØ¥ÙÙ„ÙÙŠÙ’Ù‡Ù Ø§Ù„Ù†ÙÙ‘Ø´ÙÙˆØ±Ù',tr:'Alhamdulillahil laziy ahyana ba\'da ma amatana va ilayhinnushur',uz:'Bizni o\'ldirganidan keyin tiriltirgani uchun hamd bo\'lsin Allohga. Qayta tirilish Unga qaytishdir.'},
    {title:'Uydan chiqishda',ar:'Ø¨ÙØ³Ù’Ù…Ù Ø§Ù„Ù„Ù‡Ù ØªÙÙˆÙÙƒÙÙ‘Ù„Ù’ØªÙ Ø¹ÙÙ„ÙÙ‰ Ø§Ù„Ù„Ù‡Ù ÙˆÙÙ„ÙØ§ Ø­ÙÙˆÙ’Ù„Ù ÙˆÙÙ„ÙØ§ Ù‚ÙÙˆÙÙ‘Ø©Ù Ø¥ÙÙ„ÙÙ‘Ø§ Ø¨ÙØ§Ù„Ù„Ù‡Ù',tr:'Bismillahi tavakkaltu alallahi va la hawla va la quvvata illa billah',uz:'Alloh nomi bilan. Allohga tavakkal qildim. Kuch va quvvat faqat Allohda.'},
    {title:'Uyga kirishda',ar:'Ø§Ù„Ù„ÙÙ‘Ù‡ÙÙ…ÙÙ‘ Ø¥ÙÙ†ÙÙ‘ÙŠ Ø£ÙØ³Ù’Ø£ÙÙ„ÙÙƒÙ Ø®ÙÙŠÙ’Ø±Ù Ø§Ù„Ù’Ù…ÙÙˆÙ’Ù„ÙØ¬Ù ÙˆÙØ®ÙÙŠÙ’Ø±Ù Ø§Ù„Ù’Ù…ÙØ®Ù’Ø±ÙØ¬Ù',tr:'Allohumma inni as\'aluka khayral mawliji va khayral makhraj',uz:'Allohim! Uyga kirishda va chiqishda yaxshilik ato qilishingni so\'rayman.'},
    {title:'Kechqurun',ar:'Ø£ÙÙ…Ù’Ø³ÙÙŠÙ’Ù†ÙØ§ ÙˆÙØ£ÙÙ…Ù’Ø³ÙÙ‰ Ø§Ù„Ù’Ù…ÙÙ„Ù’ÙƒÙ Ù„ÙÙ„ÙÙ‘Ù‡Ù ÙˆÙØ§Ù„Ù’Ø­ÙÙ…Ù’Ø¯Ù Ù„ÙÙ„ÙÙ‘Ù‡Ù',tr:'Amsayna va amsal mulku lillahi valhamdulillah',uz:'Kechqururimiz ham, barcha mulk ham Allohga tegishli. Allohga hamd bo\'lsin.'},
  ],
  'Namozdan keyin':[
    {title:'Namoz salomsidan keyin',ar:'Ø£ÙØ³Ù’ØªÙØºÙ’ÙÙØ±Ù Ø§Ù„Ù„Ù‡Ù Û Ø£ÙØ³Ù’ØªÙØºÙ’ÙÙØ±Ù Ø§Ù„Ù„Ù‡Ù Û Ø£ÙØ³Ù’ØªÙØºÙ’ÙÙØ±Ù Ø§Ù„Ù„Ù‡Ù Û Ø§Ù„Ù„ÙÙ‘Ù‡ÙÙ…ÙÙ‘ Ø£ÙÙ†Ù’ØªÙ Ø§Ù„Ø³ÙÙ‘Ù„ÙØ§Ù…Ù ÙˆÙÙ…ÙÙ†Ù’ÙƒÙ Ø§Ù„Ø³ÙÙ‘Ù„ÙØ§Ù…Ù ØªÙØ¨ÙØ§Ø±ÙÙƒÙ’ØªÙ ÙŠÙØ§ Ø°ÙØ§ Ø§Ù„Ù’Ø¬ÙÙ„ÙØ§Ù„Ù ÙˆÙØ§Ù„Ø¥ÙÙƒÙ’Ø±ÙØ§Ù…Ù',tr:'Astagfirulloh (3 marta). Allohumma antas-salam va minkas-salam, tabarakta ya zal jalali val ikrom',uz:'Allohdan kechim so\'rayman (3 marta). Allohim! Sen Salomsan, Senda salom bor. Ey jalol va ikrom sohibi, Sen mubaraksan.'},
    {title:'Oyat ul-Kursi',ar:'Ø§Ù„Ù„Ù‡Ù Ù„ÙØ§ Ø¥ÙÙ„ÙÙ‡Ù Ø¥ÙÙ„ÙÙ‘Ø§ Ù‡ÙÙˆÙ Ø§Ù„Ù’Ø­ÙÙŠÙÙ‘ Ø§Ù„Ù’Ù‚ÙÙŠÙÙ‘ÙˆÙ…Ù Ù„ÙØ§ ØªÙØ£Ù’Ø®ÙØ°ÙÙ‡Ù Ø³ÙÙ†ÙØ©ÙŒ ÙˆÙÙ„ÙØ§ Ù†ÙÙˆÙ’Ù…ÙŒ',tr:'Allahu la ilaha illa huwal-hayyul-qayyum, la ta\'khuzuhu sinatun va la nawm',uz:'Alloh â€” Undan boshqa iloh yo\'q. U Tirik va Abadiydir. Uni na mudroq, na uyqu tutmaydi.'},
    {title:'Subhanalloh, Alhamdulillah, Allahu Akbar',ar:'Ø³ÙØ¨Ù’Ø­ÙØ§Ù†Ù Ø§Ù„Ù„Ù‡Ù Ù£Ù£ Û Ø§Ù„Ù’Ø­ÙÙ…Ù’Ø¯Ù Ù„ÙÙ„ÙÙ‘Ù‡Ù Ù£Ù£ Û Ø§Ù„Ù„Ù‡Ù Ø£ÙÙƒÙ’Ø¨ÙØ±Ù Ù£Ù£',tr:'33 marta Subhanalloh, 33 marta Alhamdulillah, 33 marta Allahu Akbar',uz:'Har namozdan keyin ushbu tasbihotlarni 33 martadan aytish sunnatidir.'},
  ],
  'Uxlash':[
    {title:'Uxlashdan oldin',ar:'Ø¨ÙØ§Ø³Ù’Ù…ÙÙƒÙ Ø§Ù„Ù„ÙÙ‘Ù‡ÙÙ…ÙÙ‘ Ø£ÙÙ…ÙÙˆØªÙ ÙˆÙØ£ÙØ­Ù’ÙŠÙØ§',tr:'Bismika Allohumma amutu va ahya',uz:'Allohim! Sening isming bilan o\'laman va yashaman.'},
    {title:'Uyquda qo\'rqqanda',ar:'Ø£ÙØ¹ÙÙˆØ°Ù Ø¨ÙÙƒÙÙ„ÙÙ…ÙØ§ØªÙ Ø§Ù„Ù„Ù‡Ù Ø§Ù„ØªÙÙ‘Ø§Ù…ÙÙ‘Ø§ØªÙ Ù…ÙÙ†Ù’ ØºÙØ¶ÙØ¨ÙÙ‡Ù ÙˆÙØ¹ÙÙ‚ÙØ§Ø¨ÙÙ‡Ù ÙˆÙØ´ÙØ±ÙÙ‘ Ø¹ÙØ¨ÙØ§Ø¯ÙÙ‡Ù',tr:'A\'uzu bikalimmatillahit-tammati min ghadabihi va iqabihi va sharri ibadihi',uz:'Allohning to\'liq kalimalaridan â€” Uning g\'azabi, azobivabandalalarining yomonligidan panoh so\'rayman.'},
  ],
  'Ovqat':[
    {title:'Ovqat oldidan',ar:'Ø¨ÙØ³Ù’Ù…Ù Ø§Ù„Ù„Ù‡Ù ÙˆÙØ¹ÙÙ„ÙÙ‰ Ø¨ÙØ±ÙÙƒÙØ©Ù Ø§Ù„Ù„Ù‡Ù',tr:'Bismillahi va ala barakatillah',uz:'Alloh nomi bilan va Allohning barakasi bilan.'},
    {title:'Ovqatdan keyin',ar:'Ø§Ù„Ù’Ø­ÙÙ…Ù’Ø¯Ù Ù„ÙÙ„ÙÙ‘Ù‡Ù Ø§Ù„ÙÙ‘Ø°ÙÙŠ Ø£ÙØ·Ù’Ø¹ÙÙ…ÙÙ†ÙØ§ ÙˆÙØ³ÙÙ‚ÙØ§Ù†ÙØ§ ÙˆÙØ¬ÙØ¹ÙÙ„ÙÙ†ÙØ§ Ù…ÙÙ†Ù Ø§Ù„Ù’Ù…ÙØ³Ù’Ù„ÙÙ…ÙÙŠÙ†Ù',tr:'Alhamdulillahil laziy at\'amana va saqana va ja\'alana minal muslimin',uz:'Bizni yedirgan, ichirgan va musulmon qilgan Allohga hamd bo\'lsin.'},
  ],
  'Safar':[
    {title:'Safar uchun',ar:'Ø³ÙØ¨Ù’Ø­ÙØ§Ù†Ù Ø§Ù„ÙÙ‘Ø°ÙÙŠ Ø³ÙØ®ÙÙ‘Ø±Ù Ù„ÙÙ†ÙØ§ Ù‡ÙØ°ÙØ§ ÙˆÙÙ…ÙØ§ ÙƒÙÙ†ÙÙ‘Ø§ Ù„ÙÙ‡Ù Ù…ÙÙ‚Ù’Ø±ÙÙ†ÙÙŠÙ†Ù ÙˆÙØ¥ÙÙ†ÙÙ‘Ø§ Ø¥ÙÙ„ÙÙ‰ Ø±ÙØ¨ÙÙ‘Ù†ÙØ§ Ù„ÙÙ…ÙÙ†Ù’Ù‚ÙÙ„ÙØ¨ÙÙˆÙ†Ù',tr:'Subhanalladzi sakhkhara lana haza va ma kunna lahu muqrinin, va inna ila rabbina lamunqalibun',uz:'Buni bizga bo\'ysundirgan Alloh pokladir, biz unga qodir emasedik. Biz Robbimizga qaytuvchilarmiz.'},
  ],
  'Tahorat':[
    {title:'Tahoratdan keyin',ar:'Ø£ÙØ´Ù’Ù‡ÙØ¯Ù Ø£ÙÙ†Ù’ Ù„ÙØ§ Ø¥ÙÙ„ÙÙ‡Ù Ø¥ÙÙ„ÙÙ‘Ø§ Ø§Ù„Ù„Ù‡Ù ÙˆÙØ£ÙØ´Ù’Ù‡ÙØ¯Ù Ø£ÙÙ†ÙÙ‘ Ù…ÙØ­ÙÙ…ÙÙ‘Ø¯Ù‹Ø§ Ø¹ÙØ¨Ù’Ø¯ÙÙ‡Ù ÙˆÙØ±ÙØ³ÙÙˆÙ„ÙÙ‡Ù',tr:'Ashhadu alla ilaha illalloh va ashhadu anna Muhammadan abduhu va rosuluh',uz:'Allohdan boshqa iloh yo\'qligiga va Muhammadning Uning bandi va elchisi ekanligiga guvohlik beraman.'},
  ],
};
let activeDuaCat=0;

/* â”€â”€â”€ Namoz o'rgatish data â”€â”€â”€ */
const TAHORAT_STEPS=[
  {ico:'ğŸ¤²',ttl:'Niyat',ar:'Ù†ÙÙˆÙÙŠÙ’ØªÙ Ø£ÙÙ†Ù’ Ø£ÙØªÙÙˆÙØ¶ÙÙ‘Ø£Ù',tr:'Navaytu an atavazza\'',desc:'Yurakda niyat qilish â€” Alloh uchun tahorat olaman. Niyat tildan ham aytilishi mumkin.'},
  {ico:'ğŸ¤²',ttl:'Bismillah',ar:'Ø¨ÙØ³Ù’Ù…Ù Ø§Ù„Ù„Ù‡Ù Ø§Ù„Ø±ÙÙ‘Ø­Ù’Ù…Ù°Ù†Ù Ø§Ù„Ø±ÙÙ‘Ø­ÙÙŠÙ…Ù',tr:'Bismillahir rohmanir rohiym',desc:'Tahoratni Alloh nomi bilan boshlash sunnatidir.'},
  {ico:'ğŸ‘',ttl:'Qo\'llarni yuvish (3x)',ar:'',tr:'',desc:'Bilak bo\'g\'imigacha ikkala qo\'lni 3 marta yuvish. Avval o\'ng qo\'l, keyin chap.'},
  {ico:'ğŸ’§',ttl:'Og\'izni chayish (3x)',ar:'',tr:'',desc:'Og\'izga suv olib yaxshilab chayqash â€” 3 marta.'},
  {ico:'ğŸ’§',ttl:'Burun yuvish (3x)',ar:'',tr:'',desc:'Burunga suv tortib, keyin puflab tashqariga chiqarish â€” 3 marta.'},
  {ico:'ğŸ«§',ttl:'Yuzni yuvish (3x)',ar:'',tr:'',desc:'Peshonadan iyak ostiga, ikki quloq o\'rtasini to\'liq â€” 3 marta.'},
  {ico:'ğŸ’ª',ttl:'Qo\'llar (tirsak bilan, 3x)',ar:'',tr:'',desc:'O\'ng qo\'lni tirsak bo\'g\'imigacha 3 marta yuvish, keyin chap qo\'lni.'},
  {ico:'ğŸ–ï¸',ttl:'Boshni masÑ… qilish (1x)',ar:'',tr:'',desc:'Ho\'l qo\'l bilan boshni peshonadan orqaga bir marta masÑ… qilish.'},
  {ico:'ğŸ‘‚',ttl:'Quloqlarni masÑ… qilish',ar:'',tr:'',desc:'Bosh barmoq â€” quloq orqasi, ko\'rsatkich barmoq â€” quloq ichi.'},
  {ico:'ğŸ¦¶',ttl:'Oyoqlarni yuvish (3x)',ar:'',tr:'',desc:'O\'ng oyoqni to\'pig\'igacha 3 marta, keyin chap oyoqni. Barmoqlar orasi yuvilib chiqiladi.'},
  {ico:'ğŸ¤²',ttl:'Tahorat duosi',ar:'Ø£ÙØ´Ù’Ù‡ÙØ¯Ù Ø£ÙÙ†Ù’ Ù„ÙØ§ Ø¥ÙÙ„ÙÙ‡Ù Ø¥ÙÙ„ÙÙ‘Ø§ Ø§Ù„Ù„Ù‡Ù ÙˆÙØ£ÙØ´Ù’Ù‡ÙØ¯Ù Ø£ÙÙ†ÙÙ‘ Ù…ÙØ­ÙÙ…ÙÙ‘Ø¯Ù‹Ø§ Ø¹ÙØ¨Ù’Ø¯ÙÙ‡Ù ÙˆÙØ±ÙØ³ÙÙˆÙ„ÙÙ‡Ù',tr:'Ashhadu alla ilaha illalloh va ashhadu anna Muhammadan abduhu va rosuluh',desc:'Tahorat tugagach osmonga qarab bu duoni o\'qish sunnat.'},
];

const PRAYER_GUIDE=[
  {ico:'ğŸŒ…',name:'Bomdod (Fajr)',rakat:'2 sunnat + 2 farz',time:'Tong otishidan quyosh chiqqunga qadar',
   steps:[
    {t:'Niyat (sunnat)',ar:'Ù†ÙÙˆÙÙŠÙ’ØªÙ Ø£ÙØµÙÙ„ÙÙ‘ÙŠ Ø³ÙÙ†ÙÙ‘Ø©Ù Ø§Ù„Ù’ÙÙØ¬Ù’Ø±Ù',tr:'Navaytu usalli sunnatal fajr',uz:'Bomdod sunnatini o\'qishga niyat qildim'},
    {t:'Takbiratul ihrom',ar:'Ø§ÙÙ„Ù„Ù‡Ù Ø£ÙÙƒÙ’Ø¨ÙØ±Ù',tr:'Allahu Akbar',uz:'Qo\'llar quloqqa tekizib aytiladi, keyin ko\'krak ustiga qo\'yiladi'},
    {t:'Sano',ar:'Ø³ÙØ¨Ù’Ø­ÙØ§Ù†ÙÙƒÙ Ø§Ù„Ù„ÙÙ‘Ù‡ÙÙ…ÙÙ‘ ÙˆÙØ¨ÙØ­ÙÙ…Ù’Ø¯ÙÙƒÙ ÙˆÙØªÙØ¨ÙØ§Ø±ÙÙƒÙ Ø§Ø³Ù’Ù…ÙÙƒÙ ÙˆÙØªÙØ¹ÙØ§Ù„ÙÙ‰ Ø¬ÙØ¯ÙÙ‘ÙƒÙ ÙˆÙÙ„ÙØ§ Ø¥ÙÙ„ÙÙ‡Ù ØºÙÙŠÙ’Ø±ÙÙƒÙ',tr:'Subhanakallahumma va bihamdika va tabarokasmuka va ta\'ala jadduka va la ilaha gayruk',uz:'Allohim! Seni hamd bilan poklayapman. Isming muborak, ulug\'liging yuksak, Sendan boshqa iloh yo\'q'},
    {t:'Fotiha + Sura',ar:'Ø¨ÙØ³Ù’Ù…Ù Ø§Ù„Ù„Ù‡Ù Ø§Ù„Ø±ÙÙ‘Ø­Ù’Ù…Ù°Ù†Ù Ø§Ù„Ø±ÙÙ‘Ø­ÙÙŠÙ…Ù Û Ø§Ù„Ù’Ø­ÙÙ…Ù’Ø¯Ù Ù„ÙÙ„ÙÙ‘Ù‡Ù Ø±ÙØ¨ÙÙ‘ Ø§Ù„Ù’Ø¹ÙØ§Ù„ÙÙ…ÙÙŠÙ†Ù...',tr:'Bismillah â†’ Fotiha â†’ qo\'shimcha sura (masalan Al-Ikhlos)',uz:'1-rakatda Fotiha + qo\'shimcha sura o\'qiladi'},
    {t:'Ruku\'',ar:'Ø³ÙØ¨Ù’Ø­ÙØ§Ù†Ù Ø±ÙØ¨ÙÙ‘ÙŠÙ Ø§Ù„Ù’Ø¹ÙØ¸ÙÙŠÙ…Ù',tr:'Subhana Rabbiyal Aziym (3x)',uz:'Egilib, qo\'llar tizzaga â€” 3 marta aytiladi'},
    {t:'Qiyom (ruku\'dan turgach)',ar:'Ø³ÙÙ…ÙØ¹Ù Ø§Ù„Ù„Ù‡Ù Ù„ÙÙ…ÙÙ†Ù’ Ø­ÙÙ…ÙØ¯ÙÙ‡Ù Û Ø±ÙØ¨ÙÙ‘Ù†ÙØ§ Ù„ÙÙƒÙ Ø§Ù„Ù’Ø­ÙÙ…Ù’Ø¯Ù',tr:'Sami\'allahu liman hamidah â€” Rabbana lakal hamd',uz:'Tiklanib aytiladi'},
    {t:'1-sajda',ar:'Ø³ÙØ¨Ù’Ø­ÙØ§Ù†Ù Ø±ÙØ¨ÙÙ‘ÙŠÙ Ø§Ù„Ø£ÙØ¹Ù’Ù„ÙÙ‰',tr:'Subhana Rabbiyal A\'la (3x)',uz:'Peshona, burun, ikki kaft, tizza, barmoqlar yerga tegishi kerak'},
    {t:'Jalsa (o\'tirish)',ar:'Ø±ÙØ¨ÙÙ‘ Ø§ØºÙ’ÙÙØ±Ù’ Ù„ÙÙŠ',tr:'Rabbigfirli',uz:'Ikki sajda orasida o\'tirib aytiladi'},
    {t:'2-sajda',ar:'Ø³ÙØ¨Ù’Ø­ÙØ§Ù†Ù Ø±ÙØ¨ÙÙ‘ÙŠÙ Ø§Ù„Ø£ÙØ¹Ù’Ù„ÙÙ‰',tr:'Subhana Rabbiyal A\'la (3x)',uz:'2-rakat uchun qaytib turiladi â€” Fotiha + Sura'},
    {t:'Qa\'da â€” Attahiyyat',ar:'Ø§Ù„ØªÙÙ‘Ø­ÙÙŠÙÙ‘Ø§ØªÙ Ù„ÙÙ„ÙÙ‘Ù‡Ù ÙˆÙØ§Ù„ØµÙÙ‘Ù„ÙÙˆÙØ§ØªÙ ÙˆÙØ§Ù„Ø·ÙÙ‘ÙŠÙÙ‘Ø¨ÙØ§ØªÙ Û Ø§Ù„Ø³ÙÙ‘Ù„ÙØ§Ù…Ù Ø¹ÙÙ„ÙÙŠÙ’ÙƒÙ Ø£ÙÙŠÙÙ‘Ù‡ÙØ§ Ø§Ù„Ù†ÙÙ‘Ø¨ÙÙŠÙÙ‘ ÙˆÙØ±ÙØ­Ù’Ù…ÙØ©Ù Ø§Ù„Ù„Ù‡Ù ÙˆÙØ¨ÙØ±ÙÙƒÙØ§ØªÙÙ‡Ù Û Ø§Ù„Ø³ÙÙ‘Ù„ÙØ§Ù…Ù Ø¹ÙÙ„ÙÙŠÙ’Ù†ÙØ§ ÙˆÙØ¹ÙÙ„ÙÙ‰ Ø¹ÙØ¨ÙØ§Ø¯Ù Ø§Ù„Ù„Ù‡Ù Ø§Ù„ØµÙÙ‘Ø§Ù„ÙØ­ÙÙŠÙ†Ù Û Ø£ÙØ´Ù’Ù‡ÙØ¯Ù Ø£ÙÙ†Ù’ Ù„ÙØ§ Ø¥ÙÙ„ÙÙ‡Ù Ø¥ÙÙ„ÙÙ‘Ø§ Ø§Ù„Ù„Ù‡Ù ÙˆÙØ£ÙØ´Ù’Ù‡ÙØ¯Ù Ø£ÙÙ†ÙÙ‘ Ù…ÙØ­ÙÙ…ÙÙ‘Ø¯Ù‹Ø§ Ø¹ÙØ¨Ù’Ø¯ÙÙ‡Ù ÙˆÙØ±ÙØ³ÙÙˆÙ„ÙÙ‡Ù',tr:'Attahiyyatu lillahi... (to\'liq Attahiyyat)',uz:'2-rakatdan keyin o\'tirib o\'qiladi'},
    {t:'Salom',ar:'Ø§Ù„Ø³ÙÙ‘Ù„ÙØ§Ù…Ù Ø¹ÙÙ„ÙÙŠÙ’ÙƒÙÙ…Ù’ ÙˆÙØ±ÙØ­Ù’Ù…ÙØ©Ù Ø§Ù„Ù„Ù‡Ù',tr:'Assalamu alaykum wa rohmatulloh',uz:'O\'ng, so\'ng chap tomonga salom â€” 2 rakat sunnat tamom. Endi 2 rakat farz â€” farz niyati bilan'},
  ]},
  {ico:'â˜€ï¸',name:'Peshin (Zuhr)',rakat:'4 sunnat + 4 farz + 2 sunnat',time:'Quyosh tepadan og\'ishidan Asr vaqtigacha',
   steps:[
    {t:'4 rakat sunnat niyati',ar:'Ù†ÙÙˆÙÙŠÙ’ØªÙ Ø£ÙØµÙÙ„ÙÙ‘ÙŠ Ø³ÙÙ†ÙÙ‘Ø©Ù Ø§Ù„Ø¸ÙÙ‘Ù‡Ù’Ø±Ù',tr:'Navaytu usalli sunnatal zuhr',uz:'1-2 rakatda Fotiha+Sura, 3-4 rakatda faqat Fotiha. 2-rakatdan keyin Attahiyyat, oxirida Attahiyyat + Salovat + Salom'},
    {t:'4 rakat farz niyati',ar:'Ù†ÙÙˆÙÙŠÙ’ØªÙ Ø£ÙØµÙÙ„ÙÙ‘ÙŠ ÙÙØ±Ù’Ø¶Ù Ø§Ù„Ø¸ÙÙ‘Ù‡Ù’Ø±Ù',tr:'Navaytu usalli fardal zuhr',uz:'Farz ham xuddi sunnat kabi â€” 4 rakat'},
    {t:'Salovat (oxirgi qa\'dada)',ar:'Ø§ÙÙ„Ù„ÙÙ‘Ù‡ÙÙ…ÙÙ‘ ØµÙÙ„ÙÙ‘ Ø¹ÙÙ„ÙÙ‰ Ù…ÙØ­ÙÙ…ÙÙ‘Ø¯Ù ÙˆÙØ¹ÙÙ„ÙÙ‰ Ø¢Ù„Ù Ù…ÙØ­ÙÙ…ÙÙ‘Ø¯Ù',tr:'Allohumma solli ala Muhammad va ala ali Muhammad...',uz:'Attahiyyatdan keyin Salovat, keyin Robbana duosi, keyin Salom'},
   ]},
  {ico:'ğŸŒ‡',name:'Asr',rakat:'4 sunnat + 4 farz',time:'Peshin tugagandan Quyosh botgunga qadar',
   steps:[
    {t:'4 rakat sunnat niyati',ar:'Ù†ÙÙˆÙÙŠÙ’ØªÙ Ø£ÙØµÙÙ„ÙÙ‘ÙŠ Ø³ÙÙ†ÙÙ‘Ø©Ù Ø§Ù„Ù’Ø¹ÙØµÙ’Ø±Ù',tr:'Navaytu usalli sunnatal Asr',uz:'Peshin kabi 4 rakat o\'qiladi'},
    {t:'4 rakat farz',ar:'Ù†ÙÙˆÙÙŠÙ’ØªÙ Ø£ÙØµÙÙ„ÙÙ‘ÙŠ ÙÙØ±Ù’Ø¶Ù Ø§Ù„Ù’Ø¹ÙØµÙ’Ø±Ù',tr:'Navaytu usalli fardal Asr',uz:'Safarda (44+ km) Peshin va Asr 2 rakĞ°Ñ‚ga qisqaradi'},
   ]},
  {ico:'ğŸŒ†',name:'Shom (Mag\'rib)',rakat:'3 farz + 2 sunnat',time:'Quyosh botishidan shafaq yo\'qolgunga qadar',
   steps:[
    {t:'3 rakat farz niyati',ar:'Ù†ÙÙˆÙÙŠÙ’ØªÙ Ø£ÙØµÙÙ„ÙÙ‘ÙŠ ÙÙØ±Ù’Ø¶Ù Ø§Ù„Ù’Ù…ÙØºÙ’Ø±ÙØ¨Ù',tr:'Navaytu usalli fardal Magrib',uz:'1-2 rakat: Fotiha+Sura. 3-rakat: faqat Fotiha. 2-rakatdan keyin Attahiyyat, 3-rakatdan keyin Attahiyyat+Salovat+Salom'},
    {t:'2 rakat sunnat',ar:'Ù†ÙÙˆÙÙŠÙ’ØªÙ Ø£ÙØµÙÙ„ÙÙ‘ÙŠ Ø³ÙÙ†ÙÙ‘Ø©Ù Ø§Ù„Ù’Ù…ÙØºÙ’Ø±ÙØ¨Ù',tr:'Navaytu usalli sunnatal Magrib',uz:'2 rakat â€” Bomdod sunnatiga o\'xshash'},
   ]},
  {ico:'ğŸŒ™',name:'Xufton (Isha)',rakat:'4 sunnat + 4 farz + 2 sunnat + 3 vitr',time:'Shafaq yo\'qolishidan tong otgunga qadar',
   steps:[
    {t:'4 rakat sunnat',ar:'Ù†ÙÙˆÙÙŠÙ’ØªÙ Ø£ÙØµÙÙ„ÙÙ‘ÙŠ Ø³ÙÙ†ÙÙ‘Ø©Ù Ø§Ù„Ù’Ø¹ÙØ´ÙØ§Ø¡Ù',tr:'Navaytu usalli sunnatal Isha',uz:'Peshin sunnatiga o\'xshash'},
    {t:'4 rakat farz',ar:'Ù†ÙÙˆÙÙŠÙ’ØªÙ Ø£ÙØµÙÙ„ÙÙ‘ÙŠ ÙÙØ±Ù’Ø¶Ù Ø§Ù„Ù’Ø¹ÙØ´ÙØ§Ø¡Ù',tr:'Navaytu usalli fardal Isha',uz:'Peshin farziga o\'xshash'},
    {t:'3 rakat Vitr',ar:'Ù†ÙÙˆÙÙŠÙ’ØªÙ Ø£ÙØµÙÙ„ÙÙ‘ÙŠ Ø§Ù„Ù’ÙˆÙØªÙ’Ø±Ù',tr:'Navaytu usallas vitr',uz:'1-2 rakat: Fotiha+Sura â†’ Attahiyyat. 3-rakat: Fotiha+Sura â†’ Ruku\'dan oldin Qunut duosi'},
    {t:'Qunut duosi',ar:'Ø§Ù„Ù„ÙÙ‘Ù‡ÙÙ…ÙÙ‘ Ø§Ù‡Ù’Ø¯ÙÙ†ÙØ§ ÙÙÙŠÙ…ÙÙ†Ù’ Ù‡ÙØ¯ÙÙŠÙ’ØªÙ ÙˆÙØ¹ÙØ§ÙÙÙ†ÙØ§ ÙÙÙŠÙ…ÙÙ†Ù’ Ø¹ÙØ§ÙÙÙŠÙ’ØªÙ ÙˆÙØªÙÙˆÙÙ„ÙÙ‘Ù†ÙØ§ ÙÙÙŠÙ…ÙÙ†Ù’ ØªÙÙˆÙÙ„ÙÙ‘ÙŠÙ’ØªÙ',tr:'Allohumma hdina fiman hadayt...',uz:'Allohim! Hidoyat berganlaringga qo\'shib bizni ham hidoyat qil, afv berganlaringga qo\'shib bizni ham afv qil...'},
   ]},
];

/* â”€â”€â”€ Active namoz tab â”€â”€â”€ */
let activeNTab=0;
function nTab(i){activeNTab=i;[0,1,2,3].forEach(j=>document.getElementById('nt'+j).classList.toggle('on',j===i));renderNTab();}

function renderNTab(){
  const el=document.getElementById('ncontent');el.innerHTML='';
  if(activeNTab===0)renderPrayerTimes(el);
  else if(activeNTab===1)renderTasbeh(el);
  else if(activeNTab===2)renderDuas(el);
  else renderGuide(el);
}

/* â”€â”€ Namoz vaqtlari â”€â”€ */
function renderPrayerTimes(el){
  // Clock
  const now=new Date();
  const hd=document.createElement('div');hd.className='pt-header';
  hd.innerHTML=`<div class="pt-clock" id="liveClock">${now.toLocaleTimeString('uz-UZ',{hour:'2-digit',minute:'2-digit',second:'2-digit'})}</div><div class="pt-date">${now.toLocaleDateString('uz-UZ',{weekday:'long',day:'numeric',month:'long',year:'numeric'})}</div>`;
  el.appendChild(hd);
  setInterval(()=>{const c=document.getElementById('liveClock');if(c)c.textContent=new Date().toLocaleTimeString('uz-UZ',{hour:'2-digit',minute:'2-digit',second:'2-digit'});},1000);

  const loc=document.createElement('div');loc.className='pt-loc';
  loc.innerHTML=`ğŸ“ <b id="ptLocName">${document.getElementById('locName').textContent}</b>`;el.appendChild(loc);

  if(!prayerData){
    const msg=document.createElement('div');msg.className='info-box';
    msg.innerHTML='â³ Namoz vaqtlari aniqlanmoqda... (Internet kerak)';el.appendChild(msg);return;
  }

  const grid=document.createElement('div');grid.className='ptimes-grid';
  const cur=getCurrentPrayer(),nxt=nextPrayer();
  PNAMES.forEach((p,i)=>{
    const t=prayerData[p.key]||'--:--';
    const isActive=i===cur;
    const isNext=p.key===nxt;
    const card=document.createElement('div');card.className='pt-card'+(isActive?' active':'');
    card.innerHTML=`<div class="pt-ico">${p.ico}</div><div class="pt-name">${p.uz}</div><div class="pt-time">${t}</div>${isNext?'<div class="pt-next">Keyingi â–¶</div>':''}`;
    grid.appendChild(card);
  });
  el.appendChild(grid);
}

/* â”€â”€ Tasbeh â”€â”€ */
function renderTasbeh(el){
  const z=ZIKRS[activeZikr];
  const wrap=document.createElement('div');wrap.className='tasbeh-wrap';
  wrap.innerHTML=`
    <div class="tasbeh-display" id="tasbehNum">${tasbehCount}</div>
    <div style="font-size:11px;color:var(--mt);margin-bottom:8px;">/ ${tasbehTarget}</div>
    <div class="tasbeh-label">${z.ar}</div>
    <div class="tasbeh-tr">${z.uz}</div>
    <button class="tasbeh-btn" id="tasbehBtn">ğŸ¤²</button>
    <div class="tasbeh-targets">
      ${[33,99,100].map(n=>`<button class="tt-btn${n===tasbehTarget?' on':''}" onclick="setTarget(${n})">${n}</button>`).join('')}
    </div>
    <div style="font-size:12px;color:var(--mt);margin-bottom:10px;text-align:center;">Zikrni tanlang:</div>
    <div class="tasbeh-zikrs">
      ${ZIKRS.map((z,i)=>`<div class="tz-item${i===activeZikr?' on':''}" onclick="setZikr(${i})">
        <div class="tz-ar">${z.ar}</div>
        <div class="tz-uz">${z.uz}</div>
      </div>`).join('')}
    </div>
    <button class="tasbeh-reset" onclick="resetTasbeh()">ğŸ”„ Qayta boshlash</button>`;
  el.appendChild(wrap);
  document.getElementById('tasbehBtn').onclick=()=>{
    tasbehCount++;
    if(tasbehCount>=tasbehTarget){
      if(navigator.vibrate)navigator.vibrate([100,50,100,50,200]);
      tasbehCount=0;
    } else {
      if(navigator.vibrate)navigator.vibrate(30);
    }
    document.getElementById('tasbehNum').textContent=tasbehCount;
  };
}
function setTarget(n){tasbehTarget=n;tasbehCount=0;renderNTab();}
function setZikr(i){activeZikr=i;tasbehCount=0;tasbehTarget=ZIKRS[i].n;renderNTab();}
function resetTasbeh(){tasbehCount=0;renderNTab();}

/* â”€â”€ Du'olar â”€â”€ */
function renderDuas(el){
  const cats=document.createElement('div');cats.className='dua-cats';
  DUA_CATS.forEach((c,i)=>{const b=document.createElement('button');b.className='dcat'+(i===activeDuaCat?' on':'');b.textContent=c;b.onclick=()=>{activeDuaCat=i;renderDuas(document.getElementById('ncontent'));};cats.appendChild(b);});
  el.appendChild(cats);
  const list=DUAS[DUA_CATS[activeDuaCat]]||[];
  list.forEach(d=>{
    const card=document.createElement('div');card.className='dua-card';
    card.innerHTML=`<div class="dua-title">${d.title}</div><div class="dua-ar">${d.ar}</div><div class="dua-tr">${d.tr}</div><div class="dua-uz">${d.uz}</div>`;
    el.appendChild(card);
  });
}

/* â”€â”€ Namoz o'rgatish â”€â”€ */
function renderGuide(el){
  // Tahorat
  const t1=document.createElement('div');t1.className='sec-label';t1.innerHTML='ğŸ’§ Tahorat olish tartibi';el.appendChild(t1);
  const ib=document.createElement('div');ib.className='info-box';
  ib.innerHTML='<b>Tahoratni buzuvchi narsalar:</b> hojatga borish, yel chiqarish, qon oqishi, uxlab qolish, behush bo\'lish.';el.appendChild(ib);
  TAHORAT_STEPS.forEach((s,i)=>{
    const d=document.createElement('div');d.className='tahorat-step';
    d.innerHTML=`<div class="ts-hd"><div class="ts-num">${i+1}</div><div class="ts-ico">${s.ico}</div><div class="ts-ttl">${s.ttl}</div><div class="ts-arr">â–¼</div></div>
    <div class="ts-body"><div class="ts-inner">${s.ar?`<div class="ts-ar">${s.ar}</div>`:''}${s.tr?`<div class="ts-tr">${s.tr}</div>`:''}${s.desc?`<div class="ts-desc">${s.desc}</div>`:''}</div></div>`;
    d.querySelector('.ts-hd').onclick=()=>d.classList.toggle('open');el.appendChild(d);
  });
  // 5 vaqt
  const t2=document.createElement('div');t2.className='sec-label';t2.style.marginTop='20px';t2.innerHTML='ğŸ•Œ 5 Vaqt Namoz';el.appendChild(t2);
  PRAYER_GUIDE.forEach(p=>{
    const d=document.createElement('div');d.className='prayer-card';
    d.innerHTML=`<div class="pc-hd"><div class="pc-ico">${p.ico}</div><div class="pc-info"><div class="pc-name">${p.name}</div><div class="pc-sub">${p.time}</div></div><div class="pc-rakat">${p.rakat}</div><div class="pc-arr">â–¼</div></div>
    <div class="pc-body"><div class="pc-inner"><div class="pc-info-box">${p.rakat}</div>
    ${p.steps.map((s,i)=>`<div class="rakat-step"><div class="rs-num">${i+1}</div><div class="rs-cont"><div class="rs-ttl">${s.t}</div>${s.ar?`<div class="rs-ar">${s.ar}</div>`:''}${s.tr?`<div class="rs-tr">${s.tr}</div>`:''}${s.uz?`<div class="rs-uz">${s.uz}</div>`:''}</div></div>`).join('')}
    </div></div>`;
    d.querySelector('.pc-hd').onclick=()=>d.classList.toggle('open');el.appendChild(d);
  });
}

/* â•â• BOOT â•â• */
buildEditions();renderSuras(SURAHS);
updateQiblaUI();
setLoc(41.2995,69.2401,"Toshkent, O'zbekiston");
renderNTab();

if(window.Telegram?.WebApp){const tg=Telegram.WebApp;tg.ready();tg.expand();tg.setHeaderColor?.('#070d17');tg.setBackgroundColor?.('#070d17');}

startGPS();
</script>
</body>
</html>
